{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "adapter": {
      "type": "object",
      "properties": {
        "adapter": {
          "type": "string",
          "constraints": {
            "env": true,
            "fileOrModule": true,
            "serverOnly": true
          }
        },
        "options": {
          "type": "object",
          "constraints": {
            "serverOnly": true
          }
        }
      },
      "constraints": {
        "serverOnly": true
      },
      "required": ["adapter", "options"],
      "additionalProperties": false
    },
    "clientAdapter": {
      "type": "object",
      "properties": {
        "adapter": {
          "type": "string",
          "constraints": {
            "fileOrModule": true
          }
        },
        "options": {
          "type": "object"
        }
      },
      "required": ["adapter", "options"],
      "additionalProperties": false
    },
    "aggregate": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "commands": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "projection": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "snapshot": {
          "$ref": "#/definitions/adapter"
        }
      },
      "required": ["name", "commands"],
      "additionalProperties": false
    },
    "viewModel": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "projection": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "serializeState": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "deserializeState": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "validator": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "snapshot": {
          "$ref": "#/definitions/adapter"
        }
      },
      "required": ["name", "projection"],
      "additionalProperties": false
    },
    "readModel": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "projection": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "resolvers": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "storage": {
          "$ref": "#/definitions/adapter"
        }
      },
      "required": ["name", "projection", "resolvers"],
      "additionalProperties": false
    },
    "jwtCookie": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "maxAge": {
          "type": "integer"
        }
      },
      "required": ["name", "maxAge"]
    },
    "redux": {
      "type": "object",
      "properties": {
        "store": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "reducers": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "middlewares": {
          "type": "string",
          "constraints": {
            "file": true
          }
        }
      },
      "required": ["store", "reducers", "middlewares"],
      "additionalProperties": false
    },
    "auth": {
      "type": "object",
      "properties": {
        "strategies": {
          "type": "string",
          "constraints": {
            "file": true,
            "serverOnly": true
          }
        }
      },
      "additionalProperties": false,
      "required": ["strategies"]
    },
    "config": {
      "type": "object",
      "properties": {
        "port": {
          "type": ["integer", "string"],
          "constraints": {
            "env": true
          }
        },
        "index": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "routes": {
          "type": "string",
          "constraints": {
            "file": true
          }
        },
        "distDir": {
          "type": "string",
          "constraints": {
            "directory": true,
            "serverOnly": true
          }
        },
        "rootPath": {
          "type": "string"
        },
        "staticDir": {
          "type": "string",
          "constraints": {
            "directory": true
          }
        },
        "staticPath": {
          "type": "string",
          "constraints": {
            "url": true
          }
        },
        "redux": {
          "$ref": "#/definitions/redux"
        },
        "aggregates": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/aggregate"
          },
          "constraints": {
            "external": true
          }
        },
        "viewModels": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/viewModel"
          }
        },
        "readModels": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/readModel"
          },
          "constraints": {
            "external": true
          }
        },
        "sagas": {
          "type": "string",
          "constraints": {
            "file": true,
            "serverOnly": true
          }
        },
        "bus": {
          "$ref": "#/definitions/adapter"
        },
        "storage": {
          "$ref": "#/definitions/adapter"
        },
        "subscribe": {
          "$ref": "#/definitions/clientAdapter"
        },
        "auth": {
          "$ref": "#/definitions/auth"
        },
        "jwtCookie": {
          "$ref": "#/definitions/jwtCookie"
        },
        "registry": {
          "type": "string",
          "constraints": {
            "env": true,
            "serverOnly": true
          }
        },
        "env": {
          "type": "object",
          "properties": {
            "development": {
              "$ref": "#/definitions/config"
            },
            "production": {
              "$ref": "#/definitions/config"
            },
            "test": {
              "$ref": "#/definitions/config"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "$ref": "#/definitions/config"
}